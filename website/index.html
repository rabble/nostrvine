<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenVine</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="vine-final-tweaks.css?v=4">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <meta name="description" content="Watch and share 6-second looping videos">
</head>
<body>
    <!-- Header -->
    <header class="vine-header">
        <div class="vine-header-bg"></div>
        <div class="vine-header-content">
            <a href="/" class="vine-logo">OpenVine</a>
            <div class="vine-auth-buttons">
                <a href="#" class="vine-auth-btn vine-login-btn">Log in</a>
            </div>
        </div>
        <div class="vine-hero-section">
            <h1 class="vine-tagline">Return to a world of beautiful, looping videos.</h1>
            <div class="vine-search-container">
                <input type="text" class="vine-search-input" placeholder="Search" id="vineSearchInput" onkeypress="if(event.key==='Enter')searchVines()">
            </div>
            <div class="vine-app-buttons">
                <a href="#" class="vine-app-btn vine-ios-btn">
                    <span class="vine-app-icon">🍎</span>
                    <span>Get it on<br><strong>iOS</strong></span>
                </a>
                <a href="#" class="vine-app-btn vine-android-btn">
                    <span class="vine-app-icon">🤖</span>
                    <span>Get it on<br><strong>Android</strong></span>
                </a>
                <a href="#" class="vine-app-btn vine-windows-btn">
                    <span class="vine-app-icon">🪟</span>
                    <span>Get it on<br><strong>Windows</strong></span>
                </a>
                <a href="#" class="vine-app-btn vine-mac-btn">
                    <span class="vine-app-icon">💻</span>
                    <span>Get it on<br><strong>macOS</strong></span>
                </a>
                <a href="#" class="vine-app-btn vine-linux-btn">
                    <span class="vine-app-icon">🐧</span>
                    <span>Get it on<br><strong>Linux</strong></span>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="vine-main-container">
        <!-- Left Sidebar - Categories -->
        <aside class="vine-sidebar-left">
            <div class="vine-categories">
                <h3>Channels</h3>
                <div class="vine-category-grid">
                    <div class="vine-category-item vine-playlist" onclick="showPlaylist('editors-picks')" title="Editor's Picks">📝</div>
                    <div class="vine-category-item vine-playlist" onclick="showPlaylist('featured')" title="Featured">🏆</div>
                    <div class="vine-category-item" onclick="filterByCategory('comedy')" title="Comedy">😂</div>
                    <div class="vine-category-item" onclick="filterByCategory('sports')" title="Sports">🏀</div>
                    <div class="vine-category-item" onclick="filterByCategory('music')" title="Music">🎵</div>
                    <div class="vine-category-item" onclick="filterByCategory('art')" title="Art & Design">🎨</div>
                    <div class="vine-category-item" onclick="filterByCategory('animals')" title="Animals">🐾</div>
                    <div class="vine-category-item" onclick="filterByCategory('food')" title="Food">🍔</div>
                    <div class="vine-category-item" onclick="filterByCategory('family')" title="Family">👨‍👩‍👧‍👦</div>
                    <div class="vine-category-item" onclick="filterByCategory('fashion')" title="Fashion & Beauty">💄</div>
                    <div class="vine-category-item" onclick="filterByCategory('nature')" title="Nature">🌿</div>
                    <div class="vine-category-item" onclick="filterByCategory('news')" title="News & Politics">📰</div>
                    <div class="vine-category-item" onclick="filterByCategory('scary')" title="Scary">👻</div>
                    <div class="vine-category-item" onclick="filterByCategory('science')" title="Science & Tech">🔬</div>
                    <div class="vine-category-item" onclick="filterByCategory('gaming')" title="Gaming">🎮</div>
                    <div class="vine-category-item" onclick="filterByCategory('health')" title="Health & Fitness">💪</div>
                    <div class="vine-category-item" onclick="filterByCategory('dance')" title="Dance">🕺</div>
                    <div class="vine-category-item" onclick="filterByCategory('places')" title="Places & Travel">✈️</div>
                    <div class="vine-category-item" onclick="filterByCategory('vintage')" title="Vintage">📷</div>
                    <div class="vine-category-item" onclick="filterByCategory('weird')" title="Weird">🤪</div>
                    <div class="vine-category-item" onclick="filterByCategory('diy')" title="DIY">🔨</div>
                    <div class="vine-category-item" onclick="filterByCategory('cars')" title="Cars">🚗</div>
                    <div class="vine-category-item" onclick="filterByCategory('lgbt')" title="LGBTQ+">🏳️‍🌈</div>
                    <div class="vine-category-item" onclick="filterByCategory('latino')" title="Latino">🌎</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="vine-main-content">
            <!-- Featured Video -->
            <div class="vine-featured-video">
                <div class="vine-video-player">
                    <div class="vine-video-wrapper">
                        <video id="vineFeaturedPlayer" autoplay muted loop playsinline controls>
                            <source src="" type="video/mp4">
                        </video>
                        <div class="vine-unmute-overlay" id="vineUnmuteOverlay" style="display: none;">
                            <button class="vine-unmute-btn">🔊 Click for sound</button>
                        </div>
                    </div>
                    <div class="vine-video-info">
                        <div class="vine-user-avatar" id="featuredAvatar">👤</div>
                        <div class="vine-user-details">
                            <div class="vine-username" id="featuredUsername">Loading...</div>
                            <div class="vine-video-stats">
                                <span class="vine-stat-item">❤️ <span id="featuredLikes">0</span></span>
                                <span class="vine-stat-item">💬 <span id="featuredComments">0</span></span>
                                <span class="vine-stat-item">🔄 <span id="featuredReposts">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Video Grid -->
            <div class="vine-video-grid" id="vineVideoGrid">
                <!-- Videos will be dynamically loaded here -->
            </div>
            
            <!-- Featured Users Section -->
            <div class="vine-featured-users-section">
                <h3>Featured Users</h3>
                <div class="vine-featured-users-grid" id="vineFeaturedUsers">
                    <!-- Users will be dynamically loaded here -->
                </div>
            </div>
            
            <!-- Trending Section -->
            <div class="vine-trending-section">
                <h3>Trending Now</h3>
                <div class="vine-trending-grid" id="vineTrendingGrid">
                    <!-- Trending videos will be loaded here -->
                </div>
            </div>
        </main>
    </div>

    <script>
        // Sample videos with working URLs - using various OpenVine media
        const SAMPLE_VIDEOS = [
            {
                id: '1',
                url: 'https://api.openvine.co/media/1750880785012-ad9a31c4',
                thumbnail: 'https://api.openvine.co/media/1750880785012-ad9a31c4/thumb.jpg',
                username: 'maka-senpai',
                avatar: '🎭',
                likes: 6900,
                comments: 420,
                reposts: 169,
                category: 'comedy'
            },
            {
                id: '2',
                url: 'https://api.openvine.co/media/1750880795926-82a02417',
                thumbnail: 'https://api.openvine.co/media/1750880795926-82a02417/thumb.jpg',
                username: 'JEDRLEE',
                avatar: '🎵',
                likes: 4200,
                comments: 210,
                reposts: 84,
                category: 'music'
            },
            {
                id: '3',
                url: 'https://api.openvine.co/media/1750880799493-b5f9ee23',
                thumbnail: 'https://api.openvine.co/media/1750880799493-b5f9ee23/thumb.jpg',
                username: 'earth-angel',
                avatar: '🌟',
                likes: 3500,
                comments: 175,
                reposts: 70,
                category: 'music'
            },
            {
                id: '4',
                url: 'https://api.openvine.co/media/1750880839632-615418e7',
                thumbnail: 'https://api.openvine.co/media/1750880839632-615418e7/thumb.jpg',
                username: 'mysticalwanheda',
                avatar: '🥒',
                likes: 1234,
                comments: 62,
                reposts: 25,
                category: 'food'
            },
            {
                id: '5',
                url: 'https://api.openvine.co/media/1750880828791-cd2ac64a',
                thumbnail: 'https://api.openvine.co/media/1750880828791-cd2ac64a/thumb.jpg',
                username: 'Kenneth-Udut',
                avatar: '🎮',
                likes: 2100,
                comments: 105,
                reposts: 42,
                category: 'gaming'
            },
            {
                id: '6',
                url: 'https://api.openvine.co/media/1750880810482-bd49e1f2',
                thumbnail: 'https://api.openvine.co/media/1750880810482-bd49e1f2/thumb.jpg',
                username: 'MettaonDarling',
                avatar: '😂',
                likes: 2500,
                comments: 125,
                reposts: 50,
                category: 'comedy'
            },
            {
                id: '7',
                url: 'https://api.openvine.co/media/1750880817654-0c307f02',
                thumbnail: 'https://api.openvine.co/media/1750880817654-0c307f02/thumb.jpg',
                username: 'Virtual',
                avatar: '🎧',
                likes: 1800,
                comments: 90,
                reposts: 36,
                category: 'music'
            },
            {
                id: '8',
                url: 'https://api.openvine.co/media/1750880803099-6b22f0ac',
                thumbnail: 'https://api.openvine.co/media/1750880803099-6b22f0ac/thumb.jpg',
                username: 'lonelyaudios',
                avatar: '🖤',
                likes: 950,
                comments: 48,
                reposts: 19,
                category: 'art'
            },
            {
                id: '9',
                url: 'https://api.openvine.co/media/1750880814035-8583318d',
                thumbnail: 'https://api.openvine.co/media/1750880814035-8583318d/thumb.jpg',
                username: 'Anim3-Bagel',
                avatar: '⚡',
                likes: 890,
                comments: 45,
                reposts: 18,
                category: 'gaming'
            },
            // Additional working videos
            {
                id: '10',
                url: 'https://api.openvine.co/media/1750880821277-b93f8f5b',
                thumbnail: 'https://api.openvine.co/media/1750880821277-b93f8f5b/thumb.jpg',
                username: 'shinyas-lattes',
                avatar: '☕',
                likes: 720,
                comments: 36,
                reposts: 14,
                category: 'comedy'
            },
            {
                id: '11',
                url: 'https://api.openvine.co/media/1750880824877-ce853248',
                thumbnail: 'https://api.openvine.co/media/1750880824877-ce853248/thumb.jpg',
                username: 'filmmaker',
                avatar: '🎥',
                likes: 1650,
                comments: 82,
                reposts: 33,
                category: 'art'
            },
            {
                id: '12',
                url: 'https://api.openvine.co/media/1750880832437-a8e54f83',
                thumbnail: 'https://api.openvine.co/media/1750880832437-a8e54f83/thumb.jpg',
                username: 'dancer',
                avatar: '💃',
                likes: 2100,
                comments: 105,
                reposts: 42,
                category: 'dance'
            }
        ];

        const FEATURED_USERS = [
            { username: 'KingBach', avatar: '👑', followers: '16.2M' },
            { username: 'Zach King', avatar: '🎩', followers: '14.7M' },
            { username: 'Lele Pons', avatar: '💃', followers: '11.5M' },
            { username: 'Logan Paul', avatar: '🥊', followers: '9.4M' },
            { username: 'Brittany Furlan', avatar: '🌟', followers: '9.8M' }
        ];

        // State
        let currentVideos = [...SAMPLE_VIDEOS];
        let featuredVideoIndex = 0;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadFeaturedVideo();
            loadVideoGrid();
            loadFeaturedUsers();
            loadTrendingVideos();
            setupVideoAutoplay();
            loadFromVineIntegration();
            setupAudioControls();
            
            // Setup hover previews after grid is loaded
            setTimeout(setupHoverPreviews, 500);
        });

        // Setup audio controls
        function setupAudioControls() {
            const unmuteOverlay = document.getElementById('vineUnmuteOverlay');
            const player = document.getElementById('vineFeaturedPlayer');
            
            if (unmuteOverlay && player) {
                unmuteOverlay.addEventListener('click', () => {
                    isMuted = false;
                    player.muted = false;
                    unmuteOverlay.style.display = 'none';
                    player.play();
                });

                // Hide controls after interaction
                player.controls = false;
                
                // Show unmute overlay initially
                if (isMuted) {
                    unmuteOverlay.style.display = 'flex';
                }
            }
        }

        // Global mute state
        let isMuted = true;

        // Load featured video
        function loadFeaturedVideo() {
            if (currentVideos.length === 0) return;
            
            const video = currentVideos[featuredVideoIndex];
            const player = document.getElementById('vineFeaturedPlayer');
            const avatar = document.getElementById('featuredAvatar');
            const username = document.getElementById('featuredUsername');
            const likes = document.getElementById('featuredLikes');
            const comments = document.getElementById('featuredComments');
            const reposts = document.getElementById('featuredReposts');

            if (player && video.url) {
                player.src = video.url;
                player.muted = isMuted;
                player.load();
                player.play().catch(e => {
                    console.log('Autoplay prevented:', e);
                    // Try playing muted if unmuted autoplay fails
                    player.muted = true;
                    player.play().catch(e2 => console.log('Even muted autoplay failed:', e2));
                });
            }
            
            if (avatar) avatar.textContent = video.avatar;
            if (username) username.textContent = video.username;
            if (likes) likes.textContent = video.likes.toLocaleString();
            if (comments) comments.textContent = video.comments.toLocaleString();
            if (reposts) reposts.textContent = video.reposts.toLocaleString();
        }

        // Load video grid
        function loadVideoGrid() {
            const grid = document.getElementById('vineVideoGrid');
            if (!grid) return;
            
            grid.innerHTML = currentVideos.map((video, index) => `
                <div class="vine-grid-item" data-video-id="${video.id}" onclick="playVideo('${video.id}')">
                    <div class="vine-grid-thumbnail" id="thumb-${video.id}">
                        <canvas width="400" height="400" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;"></canvas>
                        <div class="vine-grid-overlay">
                            <div class="vine-grid-avatar">${video.avatar}</div>
                            <span class="vine-grid-user">${video.username}</span>
                        </div>
                    </div>
                    <div class="vine-grid-info">
                        <div class="vine-grid-avatar" style="width: 20px; height: 20px; font-size: 10px;">${video.avatar}</div>
                        <span style="font-size: 11px; color: #333;">${video.username}</span>
                        <div class="vine-grid-stats">
                            <span>❤️ ${video.likes}</span>
                            <span>💬 ${video.comments}</span>
                            <span>🔄 ${video.reposts}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add placeholder for empty slots to maintain grid
            const remainingSlots = 9 - (currentVideos.length % 9);
            if (remainingSlots < 9) {
                for (let i = 0; i < remainingSlots; i++) {
                    grid.innerHTML += '<div class="vine-grid-placeholder"></div>';
                }
            }
            
            // Generate thumbnails after grid is loaded
            setTimeout(() => generateThumbnails(), 100);
        }

        // Load featured users
        function loadFeaturedUsers() {
            const userGrid = document.getElementById('vineFeaturedUsers');
            if (!userGrid) return;
            
            const colors = ['#ff6b6b', '#4ecdc4', '#ffe66d', '#ff8cc8', '#95e1d3'];
            
            userGrid.innerHTML = FEATURED_USERS.map((user, index) => `
                <div class="vine-user-item" onclick="viewProfile('${user.username}')">
                    <div class="vine-user-avatar-large" style="background: ${colors[index % colors.length]}">
                        ${user.avatar}
                    </div>
                    <div class="vine-user-info">
                        <h4>${user.username}</h4>
                        <p>${user.followers} followers</p>
                    </div>
                </div>
            `).join('');
        }

        // Load trending videos
        function loadTrendingVideos() {
            const trendingGrid = document.getElementById('vineTrendingGrid');
            if (!trendingGrid) return;
            
            const trendingVideos = currentVideos.slice(3, 9);
            
            trendingGrid.innerHTML = trendingVideos.map((video, index) => `
                <div class="vine-grid-item" onclick="playVideo('${video.id}')">
                    <div class="vine-grid-thumbnail" id="trending-thumb-${video.id}">
                        <canvas width="400" height="400" style="width: 100%; height: 100%; position: absolute; top: 0; left: 0;"></canvas>
                        <div class="vine-grid-overlay">
                            <div class="vine-grid-avatar">${video.avatar}</div>
                            <span class="vine-grid-user">${video.username}</span>
                        </div>
                    </div>
                    <div class="vine-grid-info">
                        <div class="vine-grid-avatar" style="width: 20px; height: 20px; font-size: 10px;">${video.avatar}</div>
                        <span style="font-size: 11px; color: #333;">${video.username}</span>
                        <div class="vine-grid-stats">
                            <span>❤️ ${video.likes}</span>
                            <span>💬 ${video.comments}</span>
                            <span>🔄 ${video.reposts}</span>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Generate trending thumbnails
            setTimeout(() => {
                trendingVideos.forEach((video, index) => {
                    const canvas = document.querySelector(`#trending-thumb-${video.id} canvas`);
                    if (!canvas) return;
                    
                    const ctx = canvas.getContext('2d');
                    const colors = ['#ff6b6b', '#4ecdc4', '#ffe66d', '#ff8cc8', '#95e1d3'];
                    
                    // Generate thumbnails same as main grid
                    const tempVideo = document.createElement('video');
                    tempVideo.src = video.url;
                    tempVideo.muted = true;
                    tempVideo.crossOrigin = 'anonymous';
                    
                    tempVideo.addEventListener('loadeddata', () => {
                        tempVideo.currentTime = Math.min(1, tempVideo.duration * 0.1);
                    });
                    
                    tempVideo.addEventListener('seeked', () => {
                        try {
                            ctx.drawImage(tempVideo, 0, 0, 400, 400);
                        } catch (e) {
                            ctx.fillStyle = colors[index % colors.length];
                            ctx.fillRect(0, 0, 400, 400);
                            ctx.fillStyle = 'white';
                            ctx.font = '120px Arial';
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            ctx.fillText(video.avatar, 200, 200);
                        }
                        tempVideo.remove();
                    });
                    
                    tempVideo.addEventListener('error', () => {
                        ctx.fillStyle = colors[index % colors.length];
                        ctx.fillRect(0, 0, 400, 400);
                        ctx.fillStyle = 'white';
                        ctx.font = '120px Arial';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(video.avatar, 200, 200);
                        tempVideo.remove();
                    });
                    
                    tempVideo.load();
                });
            }, 100);
        }

        // Setup video autoplay
        function setupVideoAutoplay() {
            setInterval(() => {
                featuredVideoIndex = (featuredVideoIndex + 1) % currentVideos.length;
                loadFeaturedVideo();
            }, 6000);
        }

        // Click to toggle play/pause
        document.addEventListener('DOMContentLoaded', () => {
            const player = document.getElementById('vineFeaturedPlayer');
            if (player) {
                player.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (player.paused) {
                        player.play();
                    } else {
                        player.pause();
                    }
                });
            }
        });

        // Play video
        function playVideo(videoId) {
            const videoIndex = currentVideos.findIndex(v => v.id === videoId);
            if (videoIndex !== -1) {
                featuredVideoIndex = videoIndex;
                loadFeaturedVideo();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Setup hover preview for grid items
        function setupHoverPreviews() {
            const gridItems = document.querySelectorAll('.vine-grid-item');
            
            gridItems.forEach((item, index) => {
                const thumbnail = item.querySelector('.vine-grid-thumbnail');
                if (!thumbnail || !currentVideos[index]) return;
                
                let previewVideo = null;
                let hoverTimeout = null;
                
                item.addEventListener('mouseenter', () => {
                    // Delay preview to avoid accidental hovers
                    hoverTimeout = setTimeout(() => {
                        const video = currentVideos[index];
                        if (!video.url) return;
                        
                        // Create preview video element
                        previewVideo = document.createElement('video');
                        previewVideo.src = video.url;
                        previewVideo.muted = true;
                        previewVideo.loop = true;
                        previewVideo.style.position = 'absolute';
                        previewVideo.style.top = '0';
                        previewVideo.style.left = '0';
                        previewVideo.style.width = '100%';
                        previewVideo.style.height = '100%';
                        previewVideo.style.objectFit = 'cover';
                        previewVideo.style.zIndex = '5';
                        
                        thumbnail.appendChild(previewVideo);
                        previewVideo.play().catch(e => console.log('Preview play failed:', e));
                    }, 300); // 300ms delay before preview starts
                });
                
                item.addEventListener('mouseleave', () => {
                    // Clear timeout if mouse leaves before preview starts
                    if (hoverTimeout) {
                        clearTimeout(hoverTimeout);
                        hoverTimeout = null;
                    }
                    
                    // Remove preview video
                    if (previewVideo) {
                        previewVideo.pause();
                        previewVideo.remove();
                        previewVideo = null;
                    }
                });
            });
        }

        // Search functionality
        function searchVines() {
            const query = document.getElementById('vineSearchInput').value.trim();
            if (!query) return;
            
            console.log('Searching for:', query);
            const filtered = SAMPLE_VIDEOS.filter(v => 
                v.username.toLowerCase().includes(query.toLowerCase()) ||
                v.category.toLowerCase().includes(query.toLowerCase())
            );
            
            if (filtered.length > 0) {
                currentVideos = filtered;
                loadVideoGrid();
                loadFeaturedVideo();
                setTimeout(setupHoverPreviews, 100);
            } else {
                alert('No vines found for: ' + query);
            }
        }

        // Filter by category
        function filterByCategory(category) {
            console.log('Filtering by:', category);
            const filtered = SAMPLE_VIDEOS.filter(v => v.category === category);
            
            if (filtered.length > 0) {
                currentVideos = filtered;
                loadVideoGrid();
                loadFeaturedVideo();
                setTimeout(setupHoverPreviews, 100);
            } else {
                currentVideos = [...SAMPLE_VIDEOS];
                loadVideoGrid();
                setTimeout(setupHoverPreviews, 100);
                alert(`No ${category} vines found`);
            }
        }

        // View profile
        function viewProfile(username) {
            console.log('Viewing profile:', username);
            window.location.href = `https://app.openvine.co/profile/${username}`;
        }

        // Show playlist
        function showPlaylist(playlistType) {
            console.log('Showing playlist:', playlistType);
            
            if (playlistType === 'editors-picks') {
                // Show curated editor's picks
                currentVideos = SAMPLE_VIDEOS.filter((v, i) => i % 2 === 0); // Even indexed videos
                loadVideoGrid();
                loadFeaturedVideo();
                alert("Editor's Picks - Curated selection of the best vines!");
            } else if (playlistType === 'featured') {
                // Show featured viners' videos
                currentVideos = SAMPLE_VIDEOS.filter((v, i) => i % 2 === 1); // Odd indexed videos
                loadVideoGrid();
                loadFeaturedVideo();
                alert("Featured Viners - Trending creators and their best content!");
            }
            
            setTimeout(setupHoverPreviews, 100);
        }

        // Handle enter key in search
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('vineSearchInput');
            if (searchInput) {
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        searchVines();
                    }
                });
            }
        });

        // Try to load from vine-integration.js if available
        function loadFromVineIntegration() {
            // This will integrate with the vine-integration.js file if it loads
            if (typeof window.VineState !== 'undefined' && window.VineState.videos.length > 0) {
                currentVideos = window.VineState.videos;
                loadVideoGrid();
                loadFeaturedVideo();
                setTimeout(setupHoverPreviews, 100);
            }
        }

        // Generate video thumbnails dynamically
        function generateThumbnails() {
            currentVideos.forEach((video, index) => {
                const thumbnailContainer = document.getElementById(`thumb-${video.id}`);
                if (!thumbnailContainer) return;
                
                const canvas = thumbnailContainer.querySelector('canvas');
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                const colors = ['#ff6b6b', '#4ecdc4', '#ffe66d', '#ff8cc8', '#95e1d3'];
                
                // Create a temporary video element to extract frame
                const tempVideo = document.createElement('video');
                tempVideo.src = video.url;
                tempVideo.muted = true;
                tempVideo.crossOrigin = 'anonymous';
                
                tempVideo.addEventListener('loadeddata', () => {
                    // Seek to 1 second or 10% of video duration
                    tempVideo.currentTime = Math.min(1, tempVideo.duration * 0.1);
                });
                
                tempVideo.addEventListener('seeked', () => {
                    try {
                        // Draw the video frame to canvas
                        ctx.drawImage(tempVideo, 0, 0, 400, 400);
                    } catch (e) {
                        // If video can't be drawn (CORS, etc), create colorful placeholder
                        ctx.fillStyle = colors[index % colors.length];
                        ctx.fillRect(0, 0, 400, 400);
                        ctx.fillStyle = 'white';
                        ctx.font = '120px Arial';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(video.avatar, 200, 200);
                    }
                    
                    // Clean up
                    tempVideo.remove();
                });
                
                tempVideo.addEventListener('error', () => {
                    // Create colorful placeholder on error
                    ctx.fillStyle = colors[index % colors.length];
                    ctx.fillRect(0, 0, 400, 400);
                    ctx.fillStyle = 'white';
                    ctx.font = '120px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(video.avatar, 200, 200);
                    
                    tempVideo.remove();
                });
                
                // Start loading
                tempVideo.load();
            });
        }
    </script>
</body>
</html>